spring:
  datasource:
    url: ${DB_URL:jdbc:mysql://localhost:3306/buzzerbidder?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Seoul}
    driver-class-name: com.mysql.cj.jdbc.Driver
    username: ${DB_USERNAME:devut}
    password: ${DB_PASSWORD:buzzbidder123}
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
  
  # H2 Console 비활성화 (MySQL 사용 시)
  h2:
    console:
      enabled: false

  # JPA 설정
  jpa:
    database-platform: org.hibernate.dialect.MySQLDialect
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        use_sql_comments: true

  # Redis 설정
  data:
    redis:
      host: localhost
      port: 6379
      password:
      timeout: 2000ms
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0
          max-wait: -1ms
  # 이메일 설정
  mail:
    host: ${MAIL_HOST:smtp.gmail.com}
    port: ${MAIL_PORT:587}
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
          connectiontimeout: 5000
          timeout: 5000
          writetimeout: 5000
  web:
    error:
      include-message: always
      include-stacktrace: on_param
      include-binding-errors: always
      include-exception: false
  security:
    oauth2:
      client:
        registration:
          kakao:
            client-id: c136afd324de5358829c83363ee0ba6b
            client-secret: ${KAKAO_CLIENT_SECRET:}
            redirect-uri: http://localhost:8080/login/oauth2/code/kakao
            client-authentication-method: client_secret_post
            authorization-grant-type: authorization_code
            scope:
              - profile_nickname
              - account_email
            client-name: Kakao
          naver:
            client-id: n4GkssO1dLxOBT8PQ8Z0
            client-secret: ${NAVER_CLIENT_SECRET:}
            redirect-uri: http://localhost:8080/login/oauth2/code/naver
            client-authentication-method: client_secret_post
            authorization-grant-type: authorization_code
            scope:
              - name
              - email
              - profile_image
            client-name: Naver
          google:
            client-id: 516250457314-ilbkvu1ittv47pbugdjk3qusl4kbg47o.apps.googleusercontent.com
            client-secret: ${GOOGLE_CLIENT_SECRET}
            redirect-uri: http://localhost:8080/login/oauth2/code/google
            client-authentication-method: client_secret_post
            authorization-grant-type: authorization_code
            scope:
              - profile
              - email
            client-name: Google
        provider:
          kakao:
            authorization-uri: https://kauth.kakao.com/oauth/authorize
            token-uri: https://kauth.kakao.com/oauth/token
            user-info-uri: https://kapi.kakao.com/v2/user/me
            user-name-attribute: id
          naver:
            authorization-uri: https://nid.naver.com/oauth2.0/authorize
            token-uri: https://nid.naver.com/oauth2.0/token
            user-info-uri: https://openapi.naver.com/v1/nid/me
            user-name-attribute: response
          google:
            authorization-uri: https://accounts.google.com/o/oauth2/v2/auth
            token-uri: https://www.googleapis.com/oauth2/v4/token
            user-info-uri: https://www.googleapis.com/oauth2/v3/userinfo
            user-name-attribute: sub

  kafka:
    bootstrap-servers: localhost:9094
    producer:
      # 메시지 키는 String, 값은 JSON
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer
    consumer:
      group-id: buzzerbidder-group
      # 처음 접속 시 가장 오래된 메시지부터 읽음
      auto-offset-reset: earliest
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer
      properties:
        # JSON 역직렬화 시 신뢰할 수 있는 패키지 지정
        spring.json.trusted.packages: "devut.buzzerbidder.*"

# JWT 설정
custom:
  jwt:
    secretPattern: ${JWT_SECRET}
    expireSeconds: 1800  # 30분 (초)
    shortExpireSeconds: 600  # 10분 (초)
    refreshExpireSeconds: 604800  # 7일 (초)
  # OAuth2 임시 토큰 설정
  oauth2:
    tempTokenExpireSeconds: 300  # 5분 (초)
  # 이메일 인증 설정
  email:
    verification:
      expireMinutes: 10  # 인증 코드 유효 시간 (분)
      subject: "[BuzzerBidder] 이메일 인증 코드"
  kafka:
    topic:
      live-bid:
        name: live-bid-events
        partitions: 1
        replicas: 1

delivery:
  client-id: ${DELIVERY_CLIENT_ID}
  client-secret: ${DELIVERY_CLIENT_SECRET}

# AWS S3 설정
cloud:
  aws:
    credentials:
      access-key: ${AWS_ACCESS_KEY}
      secret-key: ${AWS_SECRET_KEY}
    s3:
      bucket: ${AWS_S3_BUCKET}
    region:
      static: ${AWS_REGION:ap-northeast-2}

# Swagger 개발 환경 추가 설정
springdoc:
  swagger-ui:
    enabled: true
    display-request-duration: true
    doc-expansion: list

  # Doppler 설정 (선택적)
doppler:
  enabled: ${DOPPLER_ENABLED:true}
  token: ${DOPPLER_TOKEN:}
  project: ${DOPPLER_PROJECT:buzzerbidder}
  config: ${DOPPLER_CONFIG:dev_main}

# 토스 설정
toss:
  secret-key: ${TOSS_SECRET_KEY}